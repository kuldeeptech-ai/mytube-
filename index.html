<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>YT Music – Safe</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:system-ui;background:#0b0b0b;color:#fff}
header{padding:12px;background:#141414;color:red;font-weight:700}
#playerBox{max-width:900px;margin:12px auto;border-radius:20px;overflow:hidden}
#playerBox iframe{width:100%;aspect-ratio:16/9;border:0}
.controls{display:flex;gap:8px;padding:12px}
.controls input{flex:1;padding:10px;background:#000;color:#fff;border:1px solid #333;border-radius:10px}
.controls button{padding:10px 14px;background:red;border:none;border-radius:10px;color:#fff}
#suggestions{padding:0 12px}
.sug{padding:8px;border-bottom:1px solid #222;cursor:pointer}
.sug:hover{background:#1a1a1a}
.feed{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;padding:12px}
.card{background:#141414;border:1px solid #333;border-radius:14px;padding:8px;cursor:pointer}
.card img{width:100%;border-radius:10px}
.card span{display:block;font-size:13px;margin-top:6px}
</style>
</head>

<body>

<header>YT Music</header>

<div id="playerBox">
  <iframe id="player" allow="autoplay; encrypted-media" allowfullscreen></iframe>
</div>

<div class="controls">
  <input id="q" placeholder="Search songs…" oninput="onType()">
  <button onclick="search()">Search</button>
</div>

<div id="suggestions"></div>
<div id="feed" class="feed"></div>

<script>
const API_KEY = "AIzaSyBc1FY-6OzcRDAPQFiok_p_h5I1RalcIc0";
const player = document.getElementById("player");
const feed = document.getElementById("feed");
const suggestions = document.getElementById("suggestions");
let typingTimer;

/* PLAY */
function play(id){
  player.src = `https://www.youtube-nocookie.com/embed/${id}?autoplay=1`;
}

/* HOME LOAD – safest endpoint */
function loadHome(){
  fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&q=music&maxResults=12&key=${API_KEY}`)
  .then(r=>r.json())
  .then(d=>{
    feed.innerHTML="";
    d.items.forEach(v=>{
      const c=document.createElement("div");
      c.className="card";
      c.innerHTML=`<img src="${v.snippet.thumbnails.medium.url}"><span>${v.snippet.title}</span>`;
      c.onclick=()=>play(v.id.videoId);
      feed.appendChild(c);
    });
  });
}

/* SEARCH */
function search(){
  const q=document.getElementById("q").value.trim();
  if(!q) return;
  fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&q=${encodeURIComponent(q)}&maxResults=12&key=${API_KEY}`)
  .then(r=>r.json())
  .then(d=>{
    feed.innerHTML="";
    d.items.forEach(v=>{
      const c=document.createElement("div");
      c.className="card";
      c.innerHTML=`<img src="${v.snippet.thumbnails.medium.url}"><span>${v.snippet.title}</span>`;
      c.onclick=()=>play(v.id.videoId);
      feed.appendChild(c);
    });
  });
}

/* LIVE SUGGESTIONS (SAFE) */
function onType(){
  clearTimeout(typingTimer);
  typingTimer=setTimeout(()=>{
    const q=document.getElementById("q").value.trim();
    if(!q){suggestions.innerHTML="";return;}
    fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=5&q=${encodeURIComponent(q)}&key=${API_KEY}`)
    .then(r=>r.json())
    .then(d=>{
      suggestions.innerHTML="";
      d.items.forEach(v=>{
        const div=document.createElement("div");
        div.className="sug";
        div.textContent=v.snippet.title;
        div.onclick=()=>{
          document.getElementById("q").value=v.snippet.title;
          suggestions.innerHTML="";
          search();
        };
        suggestions.appendChild(div);
      });
    });
  },500);
}

/* INIT */
loadHome();
</script>

</body>
</html>
